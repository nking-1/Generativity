// budget_graceful.thermo (FIXED)
// The killer demo: Graceful degradation

let _ = gaslimit(100) in

let items = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] in

// Each item does work
let expensive = fn(x) -> 
    repeat(5) { x + x + x }
in

// Shield each item so we get partial results
let results = map(item -> 
    shield (call(expensive, [item])) recover 0
, items) in

[results, entropy, mass, hologram]